<script>
    // THE SECRET: Point this ONLY to the History tab CSV link
    const BRAIN_CSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQnplVPLG6flEQ_DCD8ydwGyKlZh2xr6Gkej4RdcajQPJ1M2-CCKZvi_EDn8PKUhvHzNqe2gdgvNr2t/pub?gid=0&single=true&output=csv';

    async function loadData() {
        try {
            const response = await fetch(BRAIN_CSV);
            const text = await response.text();
            const rows = text.split('\n').map(r => r.split(','));
            
            const tbody = document.querySelector('#memberTable tbody');
            tbody.innerHTML = '';

            const latestEntries = {};
            // Skip the header row (index 0)
            rows.slice(1).forEach(row => {
                if(row[2]) {
                    // Logic: Overwrites older entries with the newest one found
                    latestEntries[row[2].trim()] = row; 
                }
            });

            Object.values(latestEntries).forEach(entry => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="font-weight:bold; color:#FF4500;">${entry[1]}</td>
                    <td>Recorded: ${entry[0]}</td>
                    <td>Member</td>
                    <td style="color:#FF4500; font-weight:bold;">${Number(entry[3]).toLocaleString()}</td>
                `;
                tbody.appendChild(tr);
            });
        } catch (e) {
            console.error("Load Failed", e);
        }
    }
    loadData();
</script>
