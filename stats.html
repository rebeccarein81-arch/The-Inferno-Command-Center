<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>INFERNO | INTELLIGENCE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Outfit:wght@900&display=swap" rel="stylesheet">
    <style>
        body { background: #050505; color: #EEE; font-family: sans-serif; margin: 0; padding: 20px; text-align: center; }
        h1 { font-family: 'Outfit', sans-serif; color: #FF4500; text-transform: uppercase; letter-spacing: 4px; margin-top: 50px; }
        .nav { margin-bottom: 30px; }
        .nav a { color: #888; text-decoration: none; margin: 0 15px; font-family: 'Orbitron', sans-serif; font-size: 0.8em; border: 1px solid #444; padding: 5px 15px; border-radius: 5px; }
        table { width: 95%; max-width: 900px; margin: 20px auto; border-collapse: collapse; background: rgba(10,10,10,0.9); border: 1px solid #FF4500; }
        th { background: #000; color: #FF4500; padding: 15px; border-bottom: 2px solid #FF4500; font-family: 'Orbitron', sans-serif; }
        td { padding: 12px; border-bottom: 1px solid #222; text-align: center; }
        .error-msg { color: #ff0000; font-family: monospace; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="nav">
        <a href="index.html">HUB</a>
        <a href="war-room.html">WAR ROOM</a>
    </div>

    <h1>Intelligence</h1>

    <table id="statsTable">
        <thead>
            <tr>
                <th>Member</th>
                <th>Date Recorded</th>
                <th>Total Stats</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr><td colspan="3">Searching for Inferno Logs...</td></tr>
        </tbody>
    </table>
    <div id="debug" class="error-msg"></div>

    <script>
        // Use the EXACT link you provided
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQnplVPLG6flEQ_DCD8ydwGyKlZh2xr6Gkej4RdcajQPJ1M2-CCKZvi_EDn8PKUhvHzNqe2gdgvNr2t/pub?gid=722061266&single=true&output=csv';

        async function loadData() {
            const tbody = document.getElementById('tableBody');
            const debug = document.getElementById('debug');

            try {
                const response = await fetch(CSV_URL);
                if (!response.ok) throw new Error("Could not connect to Google Sheets.");
                
                const text = await response.text();
                const lines = text.split('\n');
                
                if (lines.length <= 1) {
                    tbody.innerHTML = '<tr><td colspan="3">History tab is currently empty.</td></tr>';
                    return;
                }

                tbody.innerHTML = '';
                // Loop through rows, starting at 1 to skip the header
                for (let i = 1; i < lines.length; i++) {
                    const cols = lines[i].split(',');
                    if (cols.length >= 3) {
                        const tr = document.createElement('tr');
                        // Mapping: Column A (0) = Date, Column B (1) = Name, Column D (3) = Stats
                        tr.innerHTML = `
                            <td style="color:#FF4500; font-weight:bold;">${cols[1] || 'Unknown'}</td>
                            <td>${cols[0] || '---'}</td>
                            <td style="font-weight:bold;">${cols[3] ? Number(cols[3]).toLocaleString() : '0'}</td>
                        `;
                        tbody.appendChild(tr);
                    }
                }
            } catch (e) {
                console.error(e);
                tbody.innerHTML = '<tr><td colspan="3">Connection Lost</td></tr>';
                debug.innerHTML = "SYSTEM ERROR: " + e.message + "<br>Check if 'History' tab is published as CSV.";
            }
        }
        loadData();
    </script>
</body>
</html>
